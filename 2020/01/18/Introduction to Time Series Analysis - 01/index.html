<!DOCTYPE html>
<html lang="en-US">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Zhenyuan Ma">



    <meta name="description" content="Master student in McGill University 
">



<title>Introduction to Time Series Analysis - 01 | Zhenyuan Ma</title>



    <link rel="icon" href="/favicon.png">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
            <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


        
    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Zhenyuan&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                    <a class="menu-item" href="/links">Links</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Zhenyuan&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                    <a class="menu-item" href="/links">Links</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Introduction to Time Series Analysis - 01</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Zhenyuan Ma</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">2020 01 18&nbsp;&nbsp;16:51:42</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="introduction-to-time-series-analysis---01">Introduction to Time Series Analysis - 01</h2>
<p>This note is for course MATH 545 at McGill University.</p>
<h4 id="reference-book">Reference Book</h4>
<ul>
<li>Introduction to Time Series and Forecasting (by Brockwell and Davis)</li>
<li>The Analysis of Time Series: an Introduction with R (by Chatfield and Xing)</li>
</ul>
<hr>
<!--Lecture 1-->
<h5 id="time-series"><strong>Time series</strong></h5>
<p><span class="math inline">\(\{X_t\}\)</span> is a collection of random variables where \(t\) is the index of time.</p>
<h5 id="the-process-of-dealing-with-time-series"><strong>The process of dealing with time series</strong></h5>
<ol type="1">
<li>Describe by plotting to have concise summary of data</li>
<li>Explain by probabilistic models (joint distributions)</li>
<li>Predict to attain more uncertainty</li>
</ol>
<p>Note that <span class="math inline">\(X_t\)</span> is mutual independent, so we have the joint distribution <span class="math inline">\(Pr(X_1 \leq x_1, X_2 \leq x_2, ..., X_n \leq x_n) = \prod_{i=1}^n Pr(X_i \leq x_i)\)</span>. But for most complex models we assume that <span class="math inline">\(Pr(X_1 \leq x_1, X_2 \leq x_2, ..., X_n \leq x_n) = \\ Pr(X_1 \leq x_1)Pr(X_2 \leq x_2 | X_1 \leq x_1) ... Pr(X_n \leq x_n|X_1 \leq x_1 ... X_{n-1} \leq x_{n-1})\)</span>.</p>
<h5 id="semi-parametric-model"><strong>Semi-parametric model</strong></h5>
<p>In semi-parametric models, we do not specify pdf and cdf of random variables, instead we specify <span class="math inline">\(E(X_t)\)</span> and <span class="math inline">\(Cov(X_t, X_{t+j})\)</span>.</p>
<h5 id="examples"><strong>Examples</strong></h5>
<ol type="1">
<li><strong>iid noise</strong>: let <span class="math inline">\(E(X_t)=0, \forall t\)</span> and <span class="math inline">\(Pr(X_1 \leq x_1, X_2 \leq x_2, ..., X_n \leq x_n) = \prod_{i=1}^n Pr(X_i \leq x_i) = \prod_{i=1}^n F(X_n)\)</span> where <span class="math inline">\(F(\cdot)\)</span> is cumulative distribution function.</li>
<li><strong>random walk</strong>: let <span class="math inline">\(\{X_t\}\)</span> be iid noise, and <span class="math inline">\(S_t = X_1 + X_2 + ... + X_t\)</span>. Here <span class="math inline">\(S_t\)</span> is a random walk. (Note that here <span class="math inline">\(S_t\)</span> are not independent, but <span class="math inline">\(E(S_t)=0\)</span>)</li>
</ol>
<!--Lecture 2-->
<h5 id="models-with-structures"><strong>Models with structures</strong></h5>
<p>Let <span class="math inline">\(\{Y_t\}\)</span> be a time series where <span class="math inline">\(E(Y_t)=0, \forall t\)</span>. Let <span class="math inline">\(X_t=m_t + Y_t\)</span>, where <span class="math inline">\(m_t\)</span> is a slowly changing function of time. (Note that <span class="math inline">\(Y_t\)</span> here is what makes <span class="math inline">\(E(X_t)=0\)</span>, but <span class="math inline">\(m_t\)</span> here is what makes <span class="math inline">\(E(X_t) \neq 0\)</span>)</p>
<p>Some choices for <span class="math inline">\(m_t\)</span> including linear function of <span class="math inline">\(t\)</span> and polynomial function of <span class="math inline">\(t\)</span>.</p>
<h5 id="models-with-seasonal-variation-periodicity"><strong>Models with seasonal variation (periodicity)</strong></h5>
<p>Let <span class="math inline">\(X_t = S_t + Y_t\)</span>, where <span class="math inline">\(E(Y_t)=0, \forall t\)</span> and <span class="math inline">\(S_t\)</span> is a periodic function with period <span class="math inline">\(d\)</span> (i.e. <span class="math inline">\(S_{t-d}=S_t\)</span>).</p>
<p>Common choices for <span class="math inline">\(S_t\)</span> including sum of harmonic functions <span class="math inline">\(S_t = a_0 + \sum^k_{j=1}(a_j \cos(\lambda_j t) + b_j\sin(\lambda_j t))\)</span>, where <span class="math inline">\(a_j\)</span> and <span class="math inline">\(b_j\)</span> are estimated, <span class="math inline">\(\lambda_j\)</span> are fixed frequencies.</p>
<h5 id="general-strategy-for-analysis"><strong>General strategy for analysis</strong></h5>
<ol type="1">
<li>Plot the data to
<ol type="1">
<li>identify potential signal (trend, seasonal)</li>
<li>identify possible models for the rsifual process</li>
<li>identify outliers and other weird things</li>
</ol></li>
<li>Remove the signal</li>
<li>Choose a model to fit the resifual and esitimate the dependence</li>
<li>Forecast by inventory projected residuals</li>
</ol>
<h5 id="why-we-focus-on-the-residuals-i.e.-x_t---hatm_t-x_t---hats_t"><strong>Why we focus on the residuals (i.e. <span class="math inline">\(X_t - \hat{m_t}, X_t - \hat{S_t}\)</span>)</strong></h5>
<p>Let <span class="math inline">\(W_i \overset{\text{iid}}{\sim}N(\mu, \sigma^2)\)</span>, then we have <span class="math inline">\(W_i - \mu \sim N(0, \sigma^2)\)</span>. Now we can estimate <span class="math inline">\(\mu\)</span> to remove the signal, and also we can estimate <span class="math inline">\(\sigma^2\)</span>.</p>
<h5 id="stationary-process-series"><strong>Stationary process (series)</strong></h5>
<p>Let <span class="math inline">\(\{X_s\}_{s=0, 1, ..., n}\)</span> has the same properties as <span class="math inline">\(\{X_{t+s}\}_{s=0, 1, ..., n}\)</span>. (Note that we will focus on first and second order moments). iid noise is a special case of a stationary process.</p>
<p><strong><u>Def</u></strong>. <span class="math inline">\(X_t\)</span> is weakly stationary if</p>
<ol type="1">
<li><span class="math inline">\(E(X_t)=\mu_X(t)\)</span> is independent of <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(Cov(X_r, X_s)=E((X_r-\mu_X(r))(X_s-\mu_X(s)))=\gamma_X(r,s)\)</span>, where <span class="math inline">\(\gamma_X\)</span> is the covariance function of <span class="math inline">\(X_t\)</span></li>
</ol>
<p>We require that <span class="math inline">\(\gamma_X(t+h, t)\)</span> is independent of <span class="math inline">\(t\)</span> (i.e. <span class="math inline">\(\gamma_X(t+h,t)=\gamma_X(h,0)=Cov(X_h, X_0)\)</span>)</p>
<p><strong><u>Def</u></strong>. For strongly stationary, we require that the joint distribution of <span class="math inline">\(\{X_s\}_{s=0, 1, ..., n}\)</span> is the same as <span class="math inline">\(\{X_{t+s}\}_{s=0, 1, ..., n}\)</span></p>
<p>We define <span class="math inline">\(\gamma_X(h,0)=\gamma_X(h)\)</span> is the <u>auto-covariance</u> function of a stationary series of lag <span class="math inline">\(h\)</span>.</p>
<p>We define <span class="math inline">\(\rho_X(h)\)</span> is the auto-correlation function of lag <span class="math inline">\(h\)</span> and <span class="math inline">\(\rho_X(h)=\frac{\gamma_X(h)}{\gamma_X(0)}=Cor(X_{t+h},X_t)\)</span></p>
<!--Lecture 3-->
<h5 id="useful-identity"><strong>Useful identity</strong></h5>
<p>If <span class="math inline">\(E(X^2) &lt; \infty, E(Y^2) &lt; \infty, E(Z^2) &lt; \infty\)</span> and <span class="math inline">\(a,b,c\)</span> are <u>real</u> constants, then <span class="math inline">\(Cov(aX+bY+c, Z) = aCov(X,Z) + bCov(Y,Z)\)</span>.</p>
<h4 id="example-1-iid-noise"><strong>Example 1: iid noise</strong></h4>
<p><span class="math inline">\(X_t \overset{\text{iid}}{\sim}N(0, \sigma^2)\)</span></p>
<p>By definition we have <span class="math inline">\(E(X_t)=0\)</span>. If <span class="math inline">\(E(X^2) =\sigma^2 &lt; \infty\)</span>, then <span class="math inline">\(\gamma_X(h)=Cov(X_{t+h}, X_t) = \begin{cases} \sigma^2, \text{ if } h=0 \\ 0, \forall h \neq 0 \text{ by independence} \end{cases}\)</span></p>
<p>Therefore iid noise process is weakly stationary.</p>
<h5 id="example-2-white-noise-process"><strong>Example 2: White Noise Process</strong></h5>
<p>If <span class="math inline">\(\{X_t\}\)</span> is a sequence of uncorrelated random variables with <span class="math inline">\(E(X_t)=0, Var(X_t)=\sigma^2 &lt; \infty, \gamma_X(h)=0 \quad \forall h\neq 0\)</span>, then we refer to it as white noise.</p>
<p>Note that iid noise is white noise, but white noise is not necessarily iid noise.</p>
<h5 id="example-3"><strong>Example 3</strong></h5>
<p>Suppose <span class="math inline">\(\{W_t\}\)</span> and <span class="math inline">\(\{Z_t\}\)</span> are iid sequences, and <span class="math inline">\(\{W_t\} \bot \{Z_t\}\)</span>.</p>
<p>Let <span class="math inline">\(\{W_t\}\)</span> follows a Bernoulli distribution, where <span class="math inline">\(Pr(W_i=0)=Pr(W_i=1)=1/2\)</span>.</p>
<p>Let <span class="math inline">\(\{Z_t\}\)</span> follows a transformed Bernoulli distribution, where <span class="math inline">\(Pr(W_i=-1)=Pr(W_i=1)=1/2\)</span>.</p>
<p>Set <span class="math inline">\(X_t=W_t(1-W_{t-1})Z_t\)</span>, and we have the value table of <span class="math inline">\(X_t\)</span> as follows:</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(W_{t-1}\)</span></th>
<th><span class="math inline">\(W_t\)</span></th>
<th><span class="math inline">\(X_t\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td><span class="math inline">\(Z_t\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(E(X_t)=E(W_t)E(W_{t-1})E(Z_t)=\frac{1}{2} \times \frac{1}{2} \times 0 = 0\)</span></p>
<p>When calculating covariance, there are two cases:</p>
<ol type="1">
<li><span class="math inline">\(h=0\)</span></li>
</ol>
<p><span class="math inline">\(Cov(X_t,X_{t+h})=E(X_t X_{t+h})=E(W_t^2(1-W_{t-1})^2Z_t^2)\\=E(W_t^2)E((1-W_{t-1})^2)E(Z_t^2)=\frac{1}{2} \times \frac{1}{2} \times 1 = \frac{1}{4}\)</span></p>
<ol start="2" type="1">
<li><span class="math inline">\(h\neq 0\)</span></li>
</ol>
<p><span class="math inline">\(Cov(X_t,X_{t+h})=E(X_t X_{t+h})=E(W_t(1-W_{t-1})Z_tW_{t+h}(1-W_{t+h-1})Z_{t+h})\\=E(W_t)E((1-W_{t-1}))E(Z_t)E(W_{t+h})E((1-W_{t+h-1}))E(Z_{t+h})=0\)</span></p>
<p>Therefore, <span class="math inline">\(X_t\)</span> is a white noise process.</p>
<p>Note that <span class="math inline">\(X_t\)</span> and <span class="math inline">\(X_{t-1}\)</span> are dependent but not correlated.</p>
<h5 id="example-4-random-walk"><strong>Example 4: Random walk</strong></h5>
<p>Let <span class="math inline">\(\{X_t\}\)</span> be iid noise, and <span class="math inline">\(S_t = X_1 + ... + X_t = \sum^t_{i=1} X_i\)</span>.</p>
<p>We have <span class="math inline">\(E(S_t)=0\)</span>, and <span class="math inline">\(Var(S_t)=t\sigma^2\)</span>.</p>
<p><span class="math inline">\(Cov(S_{t+h}, S_t)=Cov(S_t+[X_{t+1}+...+X_{t+h}],S_t) \\= Cov(S_t,S_t) + Cov(X_{t+1}+...+X_{t+h},S_t) = t\sigma^2 + 0\)</span></p>
<p>Therefore, random walk is not stationary.</p>
<h5 id="example-5-first-order-moving-average-process-ma1"><strong>Example 5: First order moving average process (MA(1))</strong></h5>
<p>Let <span class="math inline">\(Z_t \sim WN(0, \sigma^2)\)</span>. Let <span class="math inline">\(X_t=Z_t + \theta Z_{t-1},\quad t=0,\pm1,\pm2,...\)</span> where <span class="math inline">\(\theta\)</span> is a real-valued constant.</p>
<p>(Graphical representation will be added later)</p>
<p>We have <span class="math inline">\(E(X_t)=E(Z_t) + \theta E(Z_{t-1}) = 0\)</span>.</p>
<p><span class="math inline">\(Var(X_t) = E(X_t^2) = E((Z_t + \theta Z_{t-1})^2) \\=E(Z_t^2) + 2\theta E(Z_tZ_{t-1}) + \theta^2E(Z_{t-1}^2) = (1+\theta^2)\sigma^2\)</span></p>
<p>When calculating covariance, there are three cases:</p>
<ol type="1">
<li><span class="math inline">\(h=0\)</span></li>
</ol>
<p><span class="math inline">\(\gamma_X(t+h,t)=E(X_{t+h}X_t)=E(X_t^2)=(1+\theta^2)\sigma^2\)</span></p>
<ol start="2" type="1">
<li><span class="math inline">\(h=\pm1\)</span></li>
</ol>
<p><span class="math inline">\(\gamma_X(t+h,t)=E(X_{t+h}X_t)=E((Z_{t+1}+\theta Z_t)(Z_t+\theta Z_{t-1}))\\=E(Z_{t+1}Z_t)+\theta E(Z_t^2)+\theta E(Z_{t+1}Z_{t-1})+\theta^2 E(Z_tZ_{t-1})=\theta\sigma^2\)</span></p>
<ol start="3" type="1">
<li><span class="math inline">\(|h|&gt;1\)</span></li>
</ol>
<p><span class="math inline">\(\gamma_X(t+h,t)=E(X_{t+h}X_t)=E((Z_{t+h}+\theta Z_{t+h-1})(Z_t+\theta Z_{t-1}))=0\)</span> becase <span class="math inline">\(t\neq t-1 \neq t+h \neq t+h-1\)</span> if <span class="math inline">\(|h|&gt;1\)</span></p>
<p>Therefore, MA(1) is stationary, and <span class="math inline">\(\rho_X(h)=\begin{cases} 1, \quad h=0 \\ \frac{\theta}{1+\theta^2}, \quad h=\pm1 \\ 0, \quad |h|&gt;1 \end{cases}\)</span></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Zhenyuan Ma</span>
                    </p>
                
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/time-series-model/"># time series model</a>
                    
                        <a href="/tags/mathematics/"># mathematics</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2020/01/21/Introduction to Time Series Analysis - 02/">Introduction to Time Series Analysis - 02</a>
            
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Zhenyuan Ma | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7,"opacityOnHover":0.2},"log":false});</script></body>
</html>
